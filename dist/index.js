"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = taggedTable;

function taggedTable(strings) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }

  var rowStrings = String.raw(strings).split("\n").filter(function (v) {
    return v;
  });
  var topLine = rowStrings[0];
  var cleanString = topLine.replace(/\s/g, "");
  var fields = cleanString.split("|");
  var isLastElementEmpty = !rowStrings[rowStrings.length - 1].trim();
  var argsIdx = 0;
  var rowData = isLastElementEmpty ? rowStrings.slice(1, -1) : rowStrings.slice(1);
  var expectedValueLength = rowData.length * fields.length;
  var valueCount = args.length;
  var result = rowData.map(function (row) {
    var rowDataArr = row.split("|").map(function (str) {
      return str.trim();
    });
    valueCount += rowDataArr.filter(function (v) {
      return v;
    }).length;
    return rowDataArr.reduce(function (acc, curr, idx) {
      if (curr === "") {
        var value = args[argsIdx];
        acc[fields[idx]] = value;
        argsIdx += 1;
      } else {
        acc[fields[idx]] = curr;
      }

      return acc;
    }, {});
  });

  if (expectedValueLength !== valueCount) {
    throw new Error("Table formatting error: blank cells");
  } else {
    return result;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJ0YWdnZWRUYWJsZSIsInN0cmluZ3MiLCJhcmdzIiwicm93U3RyaW5ncyIsIlN0cmluZyIsInJhdyIsInNwbGl0IiwiZmlsdGVyIiwidiIsInRvcExpbmUiLCJjbGVhblN0cmluZyIsInJlcGxhY2UiLCJmaWVsZHMiLCJpc0xhc3RFbGVtZW50RW1wdHkiLCJsZW5ndGgiLCJ0cmltIiwiYXJnc0lkeCIsInJvd0RhdGEiLCJzbGljZSIsImV4cGVjdGVkVmFsdWVMZW5ndGgiLCJ2YWx1ZUNvdW50IiwicmVzdWx0IiwibWFwIiwicm93Iiwicm93RGF0YUFyciIsInN0ciIsInJlZHVjZSIsImFjYyIsImN1cnIiLCJpZHgiLCJ2YWx1ZSIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWUsU0FBU0EsV0FBVCxDQUNiQyxPQURhLEVBR1I7QUFBQSxvQ0FERkMsSUFDRTtBQURGQSxJQUFBQSxJQUNFO0FBQUE7O0FBQ0wsTUFBTUMsVUFBVSxHQUFHQyxNQUFNLENBQUNDLEdBQVAsQ0FBV0osT0FBWCxFQUNoQkssS0FEZ0IsQ0FDVixJQURVLEVBRWhCQyxNQUZnQixDQUVULFVBQUFDLENBQUM7QUFBQSxXQUFJQSxDQUFKO0FBQUEsR0FGUSxDQUFuQjtBQUlBLE1BQU1DLE9BQU8sR0FBR04sVUFBVSxDQUFDLENBQUQsQ0FBMUI7QUFDQSxNQUFNTyxXQUFXLEdBQUdELE9BQU8sQ0FBQ0UsT0FBUixDQUFnQixLQUFoQixFQUF1QixFQUF2QixDQUFwQjtBQUNBLE1BQU1DLE1BQU0sR0FBR0YsV0FBVyxDQUFDSixLQUFaLENBQWtCLEdBQWxCLENBQWY7QUFDQSxNQUFNTyxrQkFBa0IsR0FBRyxDQUFFVixVQUFVLENBQUNBLFVBQVUsQ0FBQ1csTUFBWCxHQUFvQixDQUFyQixDQUFWLENBQWtDQyxJQUFsQyxFQUE3QjtBQUNBLE1BQUlDLE9BQU8sR0FBRyxDQUFkO0FBRUEsTUFBTUMsT0FBTyxHQUFHSixrQkFBa0IsR0FBR1YsVUFBVSxDQUFDZSxLQUFYLENBQWlCLENBQWpCLEVBQW9CLENBQUMsQ0FBckIsQ0FBSCxHQUE2QmYsVUFBVSxDQUFDZSxLQUFYLENBQWlCLENBQWpCLENBQS9EO0FBRUEsTUFBTUMsbUJBQW1CLEdBQUdGLE9BQU8sQ0FBQ0gsTUFBUixHQUFpQkYsTUFBTSxDQUFDRSxNQUFwRDtBQUNBLE1BQUlNLFVBQVUsR0FBR2xCLElBQUksQ0FBQ1ksTUFBdEI7QUFFQSxNQUFNTyxNQUFNLEdBQUdKLE9BQU8sQ0FBQ0ssR0FBUixDQUFZLFVBQUFDLEdBQUcsRUFBSTtBQUNoQyxRQUFNQyxVQUFVLEdBQUdELEdBQUcsQ0FBQ2pCLEtBQUosQ0FBVSxHQUFWLEVBQWVnQixHQUFmLENBQW1CLFVBQUFHLEdBQUc7QUFBQSxhQUFJQSxHQUFHLENBQUNWLElBQUosRUFBSjtBQUFBLEtBQXRCLENBQW5CO0FBQ0FLLElBQUFBLFVBQVUsSUFBSUksVUFBVSxDQUFDakIsTUFBWCxDQUFrQixVQUFBQyxDQUFDO0FBQUEsYUFBSUEsQ0FBSjtBQUFBLEtBQW5CLEVBQTBCTSxNQUF4QztBQUVBLFdBQU9VLFVBQVUsQ0FBQ0UsTUFBWCxDQUFrQixVQUFDQyxHQUFELEVBQWdDQyxJQUFoQyxFQUFzQ0MsR0FBdEMsRUFBOEM7QUFDckUsVUFBSUQsSUFBSSxLQUFLLEVBQWIsRUFBaUI7QUFDZixZQUFNRSxLQUFLLEdBQUc1QixJQUFJLENBQUNjLE9BQUQsQ0FBbEI7QUFDQVcsUUFBQUEsR0FBRyxDQUFDZixNQUFNLENBQUNpQixHQUFELENBQVAsQ0FBSCxHQUFtQkMsS0FBbkI7QUFDQWQsUUFBQUEsT0FBTyxJQUFJLENBQVg7QUFDRCxPQUpELE1BSU87QUFDTFcsUUFBQUEsR0FBRyxDQUFDZixNQUFNLENBQUNpQixHQUFELENBQVAsQ0FBSCxHQUFtQkQsSUFBbkI7QUFDRDs7QUFFRCxhQUFPRCxHQUFQO0FBQ0QsS0FWTSxFQVVKLEVBVkksQ0FBUDtBQVdELEdBZmMsQ0FBZjs7QUFpQkEsTUFBSVIsbUJBQW1CLEtBQUtDLFVBQTVCLEVBQXdDO0FBQ3RDLFVBQU0sSUFBSVcsS0FBSixDQUFVLHFDQUFWLENBQU47QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPVixNQUFQO0FBQ0Q7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRhZ2dlZFRhYmxlPFQ+KFxuICBzdHJpbmdzOiBUZW1wbGF0ZVN0cmluZ3NBcnJheSxcbiAgLi4uYXJnczogYW55W11cbik6IFRbXSB7XG4gIGNvbnN0IHJvd1N0cmluZ3MgPSBTdHJpbmcucmF3KHN0cmluZ3MpXG4gICAgLnNwbGl0KFwiXFxuXCIpXG4gICAgLmZpbHRlcih2ID0+IHYpO1xuXG4gIGNvbnN0IHRvcExpbmUgPSByb3dTdHJpbmdzWzBdO1xuICBjb25zdCBjbGVhblN0cmluZyA9IHRvcExpbmUucmVwbGFjZSgvXFxzL2csIFwiXCIpO1xuICBjb25zdCBmaWVsZHMgPSBjbGVhblN0cmluZy5zcGxpdChcInxcIik7XG4gIGNvbnN0IGlzTGFzdEVsZW1lbnRFbXB0eSA9ICEocm93U3RyaW5nc1tyb3dTdHJpbmdzLmxlbmd0aCAtIDFdLnRyaW0oKSk7XG4gIGxldCBhcmdzSWR4ID0gMDtcblxuICBjb25zdCByb3dEYXRhID0gaXNMYXN0RWxlbWVudEVtcHR5ID8gcm93U3RyaW5ncy5zbGljZSgxLCAtMSkgOiByb3dTdHJpbmdzLnNsaWNlKDEpO1xuXG4gIGNvbnN0IGV4cGVjdGVkVmFsdWVMZW5ndGggPSByb3dEYXRhLmxlbmd0aCAqIGZpZWxkcy5sZW5ndGg7XG4gIGxldCB2YWx1ZUNvdW50ID0gYXJncy5sZW5ndGg7XG5cbiAgY29uc3QgcmVzdWx0ID0gcm93RGF0YS5tYXAocm93ID0+IHtcbiAgICBjb25zdCByb3dEYXRhQXJyID0gcm93LnNwbGl0KFwifFwiKS5tYXAoc3RyID0+IHN0ci50cmltKCkpO1xuICAgIHZhbHVlQ291bnQgKz0gcm93RGF0YUFyci5maWx0ZXIodiA9PiB2KS5sZW5ndGg7XG5cbiAgICByZXR1cm4gcm93RGF0YUFyci5yZWR1Y2UoKGFjYzogeyBbZmllbGQ6IHN0cmluZ106IGFueSB9LCBjdXJyLCBpZHgpID0+IHtcbiAgICAgIGlmIChjdXJyID09PSBcIlwiKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXJnc1thcmdzSWR4XTtcbiAgICAgICAgYWNjW2ZpZWxkc1tpZHhdXSA9IHZhbHVlO1xuICAgICAgICBhcmdzSWR4ICs9IDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhY2NbZmllbGRzW2lkeF1dID0gY3VycjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSkgYXMgVDtcbiAgfSk7XG5cbiAgaWYgKGV4cGVjdGVkVmFsdWVMZW5ndGggIT09IHZhbHVlQ291bnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUYWJsZSBmb3JtYXR0aW5nIGVycm9yOiBibGFuayBjZWxsc1wiKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iXX0=